<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Tela de Compras</title>

  <link rel="stylesheet" href="style.css"/>
  <link rel="stylesheet" href="estilo_carrinho.css">

</head>

<body>
    <header class="topbar">
      <nav class="actions" style="display: flex; justify-content: space-between; align-items: center; padding: 20px 40px;">

        <div style="display: flex; align-items: center; justify-content: flex-start; flex: 1;">
          <a href="index.html" style="display: flex; align-items: center;">
            <img src="imagens/exemplo-logo.png" alt="" style="width: 40px; height: 40px; margin-right: 20px; margin-left: 0;">
          </a>
        </div>

        <form action="buscar.php" method="GET" style="display: flex; align-items: center; width: 500px; max-width: 100%;">
          <input type="search" id="pesquisa" name="q" placeholder="Digite sua busca..." style="font-size: 16px; width: 300px; height: 40px;">
          <button type="submit" style="margin-left: 0px; height: 40px;">
            <img src="imagens/lupa.png" alt="lupa" style="width: 28px; height: 28px;">
          </button>
        </form>
        <div style="display: flex; gap: 30px; align-items: center;">
          <a href="#">Crie a sua conta</a>
          <a href="#">Entre</a>
          <a href="#">Carrinho ðŸ›’</a>
        </div>
      </nav>
    </header>

    <div class="carrinho-layout-container">
    
      <div class="painel" id="painel-carrinho">
        </div>
    
      <div class="resumo-container">
        <h3 id="resumo-titulo" style="color: black;">Total: <span id="valor-total">R$ 0,00</span></h3>
        
        <button type="button" class="btn-continuar">Continuar a compra</button>
      </div>
    
    </div>


<script>
  // Recupera o carrinho
  let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

  const painel = document.getElementById("painel-carrinho");
  const totalSpan = document.getElementById("valor-total");
  const resumoTitulo = document.getElementById("resumo-titulo");
  const btnContinuar = document.querySelector(".btn-continuar"); // <-- NOVO: Seleciona o botÃ£o

  function renderCarrinho() {
    if (carrinho.length === 0) {
      painel.innerHTML = "<p>Nenhum produto no carrinho.</p>";
    } else {
      painel.innerHTML = carrinho.map((produto, index) => {
        const imgSrc = typeof produto.img === "string"
          ? produto.img.replace('url("', '').replace('")', '')
          : "";
        const quantidade = typeof produto.quantidade === "number" ? produto.quantidade : 1;
        const price = typeof produto.price === "number" ? produto.price : 0;
        return `
            <div class="produto" style="display: flex; align-items: center; gap: 10px;">
            <img src="${imgSrc}" alt="Produto" style="width:80px; height:80px; object-fit:cover;">
            <div style="display: flex; flex-direction: column; gap: 6px; flex: 1;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
              <p style="margin: 0;">${produto.title || ""}</p>
              <div style="display: flex; align-items: center; gap: 10px;">
                <div class="contador-container">
                <button type="button" onclick="alterarContador(${index}, -1)">-</button>
                <div id="contador${index}" class="contador-numero" style="color: black;">${quantidade}</div>
                <button type="button" onclick="alterarContador(${index}, 1)">+</button>
                </div>
                <span id="preco${index}" style="color: black; white-space: nowrap;">R$ ${(price * quantidade).toFixed(2)}</span>
              </div>
              </div>
              <div style="display: flex; align-items: center; gap: 15px; margin-top: 4px;">
                <button type="button" onclick="comprarAgora(${index})" style="color: blue; background: none; border: none; padding: 0; cursor: pointer; font-size: inherit;">Comprar agora</button>
                <button type="button" onclick="salvarDepois(${index})" style="color: blue; background: none; border: none; padding: 0; cursor: pointer; font-size: inherit;">Salvar para depois</button>
                <button type="button" onclick="removerProduto(${index})" style="color: blue; background: none; border: none; padding: 0; cursor: pointer; font-size: inherit;">Excluir</button>
              </div>
            </div>
            </div>
        `;
      }).join("");
    }
  }

  // ATUALIZADO: Atualiza o total, o tÃ­tulo do resumo E O BOTÃƒO
  function atualizarTotal() {
    if (carrinho.length === 0) {
      // Se o carrinho estiver vazio, mostra "resumo da compra"
      resumoTitulo.innerText = "resumo da compra";
      resumoTitulo.style.color = "black"; // Garante a cor
      btnContinuar.style.display = "none"; // <-- NOVO: Esconde o botÃ£o
    } else {
      // Se tiver itens, calcula o total e exibe
      const total = carrinho.reduce((acc, p) => acc + (p.price * p.quantidade), 0);
      
      // Garante que o HTML do tÃ­tulo esteja correto antes de atualizar o valor
      resumoTitulo.innerHTML = 'Total: <span id="valor-total"></span>';
      resumoTitulo.style.color = "black"; // Garante a cor
      document.getElementById("valor-total").innerText = "R$ " + total.toFixed(2).replace(".", ",");
      btnContinuar.style.display = "block"; // <-- NOVO: Mostra o botÃ£o
    }
  }

  // Alterar quantidade de produtos
  function alterarContador(index, valor) {
    const item = carrinho[index];
    item.quantidade += valor;
    if (item.quantidade < 1) item.quantidade = 1;

    localStorage.setItem("carrinho", JSON.stringify(carrinho));

    document.getElementById(`contador${index}`).textContent = item.quantidade;
    document.getElementById(`preco${index}`).textContent = "R$ " + (item.price * item.quantidade).toFixed(2);

    atualizarTotal();
  }

  // Remover produto do carrinho
  function removerProduto(index) {
    carrinho.splice(index, 1);
    localStorage.setItem("carrinho", JSON.stringify(carrinho));
    renderCarrinho();
    atualizarTotal();
  }

  // FunÃ§Ã£o para "Comprar Agora" (aÃ§Ã£o de exemplo)
  function comprarAgora(index) {
    const produto = carrinho[index];
    alert("Iniciando a compra de: " + produto.title);
    // No futuro, redirecionar para uma pÃ¡gina de checkout:
    // window.location.href = "checkout.html?item=" + produto.title;
  }

  // FunÃ§Ã£o para "Salvar para depois" (aÃ§Ã£o de exemplo)
  function salvarDepois(index) {
    const produto = carrinho[index];
    alert("Salvar para depois: " + produto.title);
    // No futuro, redirecionar para uma pÃ¡gina de checkout:
    // window.location.href = "checkout.html?item=" + produto.title;
  }


  // Inicializa a tela
  renderCarrinho();
  atualizarTotal();
</script>



</body>
</html>
